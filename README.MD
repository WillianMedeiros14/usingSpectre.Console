<h1 align="center">
 <img alt=" Spectre.Console" title=" Spectre.Console" src="https://www.nuget.org/profiles/spectresystems/avatar?imageSize=512" width="250px" />
 <br>
Spectre.Console: Interatividade e visualiza√ß√£o de dados aprimoradas para suas aplica√ß√µes de console  C#
</h1>

## üíª Oque √© a **[Spectre.Console](https://spectreconsole.net/)**?

Quando estamos iniciando os estudos em C#/.NET √© comum criar os projetos do tipo console, assim como em qualquer outra linguagem, com o objetivo de treinar as funcionalidades e parcularidades da linguagem, dessa forma entendo seu funcionamento e treinando a l√≥gica de programa√ß√£o. <br>

Com o decorrer de cada projeto vamos percebendo que podemos melhorar a interatividade e uma melhor exibi√ß√£o de dados no console, √© ai que a Spectre.Console entra. <br>

Spectre.Console √© uma biblioteca para .NET que facilita a constru√ß√£o de interfaces de linha de comando (CLIs) mais ricas e interativas. Permite exibir texto formatado, tabelas, gr√°ficos, barras de progresso, menus e muito mais diretamente no teclado, proporcionando uma experi√™ncia de usu√°rio mais interessante e informativa em aplica√ß√µes de terminal.

![Exemplo de Tabela](table.gif)

<br>

## üìÑ Documenta√ß√£o completa da Spectre.Console

No link abaixo pode ser encontrado a documenta√ß√£o completa da blioteca e com todos os seus recursos dipon√≠veis.

- **[Spectre.Console](https://spectreconsole.net/)**

## üõ†Ô∏è Como Instalar?

Instale em seu projeto pelo comando abaixo pelo NuGet:

```bash
dotnet add package Spectre.Console
```

## üìù Como utilizar?

importe a referencia namespace em sua classe e come√ße a usar os recursos.

- importan√ß√£o da refer√™cia Spectre.Console

```bash
using Spectre.Console;
```

- Exemplo b√°sico

```bash
using Spectre.Console;

public static class Program
{
    public static void Main(string[] args)
    {
        AnsiConsole.Markup("[underline red]Hello[/] World!");
    }
}
```

## üìö Exemplos

### üìö Exibi√ß√£o de livros em tabela

```bash
using Spectre.Console;

namespace BibliotecaProjeto.Modelos;

public class Livro
{
    public String Titulo { get; set; }
    public String Autor { get; set; }
    public String ISBN { get; set; }
    public DateTime DataPublicacao { get; set; }
    public bool EstaEmprestado { get; set; }

    public void ExibirInformacoes(List<Livro> livros)
    {
        if (livros.Count == 0)
        {
            Console.WriteLine("Nenhum livro dispon√≠vel.");
        }
        else
        {
            var table = new Table();
            table.AddColumn("Titulo");
            table.AddColumn("Autor");
            table.AddColumn("ISBN");
            table.AddColumn("Data de Publica√ß√£o");
            table.AddColumn("Est√° Emprestado");

            foreach (Livro livro in livros)
            {
                table.AddRow(
                    livro.Titulo,
                    livro.Autor,
                    livro.ISBN,
                   livro.DataPublicacao.ToString("dd/MM/yyyy"),
                   livro.EstaEmprestado ? "Sim" : "N√£o");
            }

            AnsiConsole.Write(table);
        }
    }

}

```

![Exemplo de Tabela](exemploTabelaLivro.png)

### üìö Menu de op√ß√µes ultilizando SelectionPrompt

```bash
using BibliotecaProjeto.Modelos;
using Spectre.Console;

namespace BibliotecaProjeto.Menus
{
internal class MenuPrincipal : Menu
{
private readonly Dictionary<int, Menu> opcoes;

        public MenuPrincipal(List<Usuario> usuarios, List<Livro> livros)
        {
            opcoes = new Dictionary<int, Menu>
            {
                { 1, new MenuRegistrarUsuario(usuarios) },
                { 2, new MenuAdicionarLivro(livros) },
                { 3, new MenuLivrosDisponiveis(livros)},
                { 4, new MenuEmprestarLivro(livros, usuarios) },
                { 5, new MenuDevolverLivro(livros, usuarios) },
                { -1, new MenuSair() }
            };
        }

        public override void Executar()
        {
            while (true)
            {
                int opcaoEscolhida = int.Parse(ExibirOpcoesDoMenu());

                if (opcoes.ContainsKey(opcaoEscolhida))
                {
                    Menu menuASerExibido = opcoes[opcaoEscolhida];
                    menuASerExibido.Executar();

                    if (opcaoEscolhida == -1)
                    {
                        break;
                    }

                    else
                    {
                        Console.Clear();
                        Console.WriteLine("Op√ß√£o inv√°lida\n");
                    }
                }
            }
        }

        private string ExibirOpcoesDoMenu()
        {
            var opcoes = new[]
            {
                "Registrar Usu√°rio",
                "Adicionar Livro",
                "Exibir Livros Dispon√≠veis",
                "Emprestar Livros",
                "Devolver Livro",
                "Sair"
            };

            string escolha = AnsiConsole.Prompt(
                new SelectionPrompt<string>()
                    .Title("Selecione uma op√ß√£o:")
                    .AddChoices(opcoes)
            );


            var opcaoEscolhida = opcoes.ToList().IndexOf(escolha) + 1;
            if (opcaoEscolhida == opcoes.Length)
            {
                opcaoEscolhida = -1;
            }

            return opcaoEscolhida.ToString();
        }
    }

}
```

![Exemplo de Menu](menu.gif)

### üìö M√∫ltiplas op√ß√µes ultilizando MultiSelectionPrompt

```bash
using BibliotecaProjeto.Modelos;
using Spectre.Console;

internal class MenuDevolverLivro : Menu
{
    private readonly List<Livro> _livros;
    private readonly List<Usuario> _usuarios;

    public MenuDevolverLivro(List<Livro> livros, List<Usuario> usuarios)
    {
        _livros = livros;
        _usuarios = usuarios;
    }

    public override void Executar()
    {
        base.Executar();
        ExibirTituloDaOpcao("Devolver Livro");

        Console.Write("Digite o CPF do Usu√°rio: ");
        string cpf = Console.ReadLine()!;

        Usuario? usuario = _usuarios.FirstOrDefault(u => u.CPF == cpf);

        if (usuario != null)
        {
            usuario.ExibirNomeECpf();

            if (usuario.LivrosEmprestados.Any())
            {

                List<Livro> livros = new List<Livro>(usuario.LivrosEmprestados)
                {
                    new Livro { Titulo = "Cancelar", Autor = "" }
                };

                MultiSelectionPrompt<Livro>? prompt = new MultiSelectionPrompt<Livro>()
                    .Title("Selecione os livros para devolver:")
                    .PageSize(10)
                    .MoreChoicesText("[grey](Use as setas para cima e para baixo para mover)[/]")
                    .InstructionsText("[yellow]Pressione [blue]<espa√ßo>[/] para selecionar uma op√ß√£o,\n[green]<enter>[/] para confirmar,\nA op√ß√£o [red]<Cancelar>[/] faz cancelar a devolu√ß√£o[/]\n\n")
                    .UseConverter(l => l.Titulo == "Cancelar" ? "[red]Cancelar[/]" : $"{l.Titulo} ({l.Autor})")
                    .AddChoices(livros);


                List<Livro>? livrosParaDevolver = AnsiConsole.Prompt(prompt);


                if (livrosParaDevolver.Any(l => l.Titulo == "Cancelar"))
                {
                    Console.WriteLine("\nOpera√ß√£o de devolu√ß√£o cancelada.");
                }
                else if (livrosParaDevolver.Any())
                {
                    foreach (var livroParaDevolver in livrosParaDevolver)
                    {
                        usuario.LivrosEmprestados.Remove(livroParaDevolver);

                        Livro? livroNaBiblioteca = _livros.FirstOrDefault(l => l.Titulo == livroParaDevolver.Titulo && l.Autor == livroParaDevolver.Autor);
                        if (livroNaBiblioteca != null)
                        {
                            livroNaBiblioteca.EstaEmprestado = false;
                        }

                        Console.WriteLine($"\nO livro '{livroParaDevolver.Titulo}' foi devolvido com sucesso.");
                    }
                }
                else
                {
                    Console.WriteLine("Nenhum livro selecionado para devolu√ß√£o.");
                }
            }
            else
            {
                Console.WriteLine("Este usu√°rio n√£o possui livros emprestados.");
            }
        }
        else
        {
            Console.WriteLine("Usu√°rio n√£o encontrado. Verifique o CPF digitado.");
        }

        Console.WriteLine("\nDigite uma tecla para voltar ao menu principal");
        Console.ReadKey();
        Console.Clear();
    }
}

```

![Exemplo de Sele√ß√£o M√∫ltipla](Sele√ß√£oMultipla.gif)

## üìö Exemplo completo

Os exemplos acima podem ser encontrados em um sistema s√≠mples de biblioteca, que pode ser encontrado no link abaixo:

- **[Projeto console de Blioteca em C#](https://github.com/WillianMedeiros14/Entregas_Estagio_Bemol/tree/Biblioteca-Semana6)**.

## üöÄ Principais recursos e tecnologias ultilizadas

- **[Documenta√ß√£o da linguagem C#](https://learn.microsoft.com/en-us/dotnet/csharp/)**.
- **[Spectre.Console](https://spectreconsole.net/)**.
